<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>情報科学基礎 - 第3回演習課題 -</title>
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/docs.min.css" rel="stylesheet">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/css/main.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body data-spy="scroll" data-target=".bs-docs-sidebar">
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">情報科学基礎演習</a>
        </div><!-- navbar-header -->

        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="index.html">ホーム</a></li>
            <li class="dropdown active">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">演習 <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="exercise.html">演習課題一覧</a></li>
                <li class="divider"></li>
                <li><a href="exercise1.html">第1回演習</a></li>
                <li><a href="exercise2.html">第2回演習</a></li>
                <li class="active"><a href="exercise3.html">第3回演習</a></li>
                <li><a href="exercise4.html">第4回演習</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">レポート <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="report.html">レポート提出方法</a></li>
                <li class="divider"></li>
                <li><a href="report0.html">レポート課題</a></li>
              </ul>
            </li>

            <li><a href="hint.html">ヒント</a></li>
            <li><a href="casl2.html">CASL II/COMET II</a></li>
            <!-- <li><a href="sitemap.html">サイトマップ</a></li> -->
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li><a href="#top" class="smoothScroll">TOPへ</a></li>
          </ul>

        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
      <div class="col-md-10 col-lg-10" role="main">
        <header class="header" id="top">
            <div class="centered">
              <h1>第3回演習課題</h1>
            </div>
        </header>

        <article>
          <!-- <section id="section1">
          <div class="row">
          <div class="col-lg-10 col-lg-offset-1 col-md-12 col-sm-12 col-xs-12">
          <h2 id="sec1">前回までの演習課題</h2><hr />
          <ul>
          <li><a href="exercise1.html">第1回演習の資料</a></li>
          <li><a href="exercise2.html">第2回演習の資料</a></li>
          </ul>
          </div>
          </div>
          </section> -->
          <section id="section2">
            <div class="row">
              <div class="col-lg-10 col-lg-offset-1 col-md-12 col-sm-12 col-xs-12">
                <h2 id="sec2">課題1：サブルーチンを使ったプログラムの作成</h2><hr />
                <h3 id="sec2-1">課題内容</h3>
                <p>以下の2つのプログラムは、ともに、IN1番地、IN2番地に保存されている2つの数値の和を求めるプログラムである。
                  2つの数の和は、サブルーチン ADDER で計算し、その結果が正しいかをメインルーチンにて判定している。
                  それぞれのプログラムの空白部分（空白には複数の命令が入る）を埋め、プログラムを完成させよ。</p>
                <h4>プログラム1</h4>
                <pre>MAIN	START
	<span style="color:red;">LAD	GR1,IN1</span>		; GR1に1つめの引数が入っているアドレスを
	<span style="color:red;">LAD	GR2,IN2</span>		; GR2に2つめの引数が入っているアドレスを
	<span style="color:red;">LAD	GR3,ANS</span>		; GR3に答えをいれてもらうアドレスを
	<span style="color:red;">CALL	ADDER</span>
	<span style="color:red;">LD	GR3,ANS</span>		; サブルーチンの答えをGR3にロード
	<span style="color:red;">CPA	GR3,=5</span>		; GR3が正しく5になっているかチェック
	JNZ	NG
	OUT	OKMSG,OKLEN
	JUMP	FIN
NG	OUT	NGMSG,NGLEN
FIN	RET
IN1	DC	3
IN2	DC	2
ANS	DS	1
NGMSG	DC	'WRONG!'
NGLEN	DC	6
OKMSG	DC	'CORRECT!'
OKLEN	DC	8
	END

ADDER	START
	(		)	; ここの処理を埋める
	RET
	END</pre>


                <h4>プログラム2</h4>
                <pre>MAIN	START
	<span style="color:red;">LD	GR1,IN1</span>		; GR1に1つめの引数を
	<span style="color:red;">LD	GR2,IN2</span>		; GR2に2つめの引数を
	<span style="color:red;">CALL	ADDER</span>		; サブルーチンADDERを呼び出す
	<span style="color:red;">CPA	GR3,=5</span>		; GR3が正しく5になっているかチェック
	JNZ	NG
	OUT	OKMSG,OKLEN
	JUMP	FIN
NG	OUT	NGMSG,NGLEN
FIN	RET
IN1	DC	3
IN2	DC	2
NGMSG	DC	'WRONG!'
NGLEN	DC	6
OKMSG	DC	'CORRECT!'
OKLEN	DC	8
	END

ADDER	START
	(		)	; ここの処理を埋める
	RET
	END</pre>

                <h3 id="sec2-2">課題の目的</h3>
                <ul>
                  <li>サブルーチンを利用したプログラム作成に慣れる</li>
                  <li>サブルーチン（メインルーチンを含む）間での値（=引数）の渡し方を学ぶ</li>
                </ul>

                <h3 id="sec2-3">ポイント</h3>
                <p>サブルーチン間での値の渡し方には、様々な方法がある。</p>
                <ol>
                  <li>汎用レジスタを利用する</li>
                  <ul style="margin-top:0px;padding-top:0px">
                    <li>データの格納場所を渡す</li>
                    <li>データの値を渡す</li>
                  </ul>
                  <li>スタック（今後の講義・演習で取り扱う予定）を利用する</li>
                </ol>
                <p>今回の課題のように、サブルーチンの仕様が与えられている場合は、サブルーチンコールの周辺（上記のプログラムの赤字部分）に注目し、どのように値を渡せば良いかを判断する必要がある。自分でプログラムを設計する場合は、それぞれの渡し方の特徴を考え、その場所に適した方法を用いれば良い。</p>

                <div class="panel panel-default explanation">
                  <div class="panel-heading">
                    <h3 class="panel-title" id="sec2-4"><i class="fa fa-pencil-square-o"></i> 解説</h3>
                  </div>
                  <div class="panel-body">
                    <p>課題の2つのプログラムは、それぞれ、データの格納場所を渡すバージョンと、データの値を渡すバージョンである。</p>
                    <p>プログラム1では、</p>
                    <pre>LAD	GR1,IN1
LAD	GR2,IN2</pre>
                    <p>から、GR1、GR2にそれぞれ1つめと2つめの引数が格納されたメモリのアドレスがロードされている。一方、プログラム2では、</p>
                    <pre>LD	GR1,IN1
LD	GR2,IN2</pre>
                    <p>から、GR1、GR2にそれぞれ1つめと2つめの引数そのものがロードされている。</p>
                    <p>サブルーチンコールが行われた後も、明示的に値を変更する命令を実行しない限り、これらレジスタの内容は変化しない。
                      また、サブルーチン側では、引数がメインルーチン（サブルーチンを呼んだ側）のIN1、IN2に格納されていることは知らないため、レジスタの値を頼りに引数を取り出す必要がある。</p>

                    <p>プログラム1の場合は、図1のようにGR1にIN1のアドレスが入っているので、そのアドレスを用いて値を取り出す。</p>
                    <div class="bs-callout" style="text-align: center;">
                      <img src="files/funcall1.png" class="img-full-width" alt="functuin call" />
                      <p style="text-align: center;">図1. プログラム1実行時のレジスター</p>
                    </div>

                    <p>一方、プログラム2では、図2のようにGR1にIN1に格納されている値そのものがロードされているので、直接計算を行えば良い。</p>
                    <div class="bs-callout" style="text-align: center;">
                      <img src="files/funcall2.png" class="img-full-width" alt="functuin call" />
                      <p style="text-align: center;">図2. プログラム2実行時のレジスター</p>
                    </div>

                    <p>レポート課題2ではメインルーチンが与えられているため、今回の課題と同様に、メインルーチンからサブルーチンにどのように値を渡すのかを、与えられたプログラムから判断する必要がある。</p>
                  </div>
                </div>
              </div>
            </div>
          </section>
          <section id="section3">
            <div class="row">
              <div class="col-lg-10 col-lg-offset-1 col-md-12 col-sm-12 col-xs-12">
                <h2 id="sec3">残りの時間は</h2><hr />
                <p><a href="report0.html">レポート課題</a>に取り組んでください。</p>
                <p><a href="hint.html#report1">ヒント</a>を書いていますので、どうしてもクリアできない部分があれば、それも参照してください。</p>
              </div>
            </div>
          </section>
          <section id="section4">
            <div class="row">
              <div class="col-lg-10 col-lg-offset-1 col-md-12 col-sm-12 col-xs-12">
                <h2 id="sec6">演習ミニレポート</h2><hr />
                <p>第三回演習の課題1の完成したプログラム1とプログラム2をCLEでアップロードしてください。</p>
              </div>
            </div>
          </section>
        </article>
      </div> <!-- role=main -->

      <div class="col-md-2 col-lg-2" role="complementary">
        <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix">
          <ul class="nav nav-list bs-docs-sidebnav">
            <li class=""><a href="#top">Top</a>
            </li>
            <!-- <li class=""><a href="#sec1">前回までの演習課題</a></li> -->
            <li class=""><a href="#sec2">課題1：サブルーチンを使ったプログラムの作成</a>
              <ul class="nav">
                <li class=""><a href="#sec2-1">課題内容</a></li>
                <li class=""><a href="#sec2-2">課題の目的</a></li>
                <li class=""><a href="#sec2-3">ポイント</a></li>
                <li class=""><a href="#sec2-4">解説</a></li>
              </ul>
            </li>
            <li class=""><a href="#sec3">残りの時間は</a></li>
          </ul>
        </nav>
      </div> <!-- role=complementary -->
    </div> <!-- container -->
    <footer class="footer">
      <div class="container">
        <p class="text-muted"><span class="copyright">Copyright &copy; 2014-2018 Yuki Koizumi. All Rights Reserved.</span></p>
      </div>
    </footer>

    <script src="assets/js/jquery-2.1.3.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/smoothscroll.js"></script>
    <!-- <script src="assets/js/docs.min.js"></script> -->
  </body>
</html>
